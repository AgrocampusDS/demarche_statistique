---
title: "TD18 : Planification exp√©rimentale (2)"
author: "UP Math√©matique appliqu√©e"
date: ''
output:
  html_document:
    theme: united
    css: style.css
    highlight: tango
mainfont: SourceSansPro
header-includes:
- \usepackage[default]{sourcesanspro}
- \usepackage[T1]{fontenc}
---


```{r setup-TD17, include=FALSE, }
knitr::opts_chunk$set(echo = FALSE, cache= TRUE, eval = TRUE, fig.show='hide', message = FALSE, warning = FALSE, results = 'hide' )
library(tidyverse)
library(kableExtra)
out_type <- knitr::opts_knit$get("rmarkdown.pandoc.to")

```

```{r}
print(out_type)

is_pdf <-  (out_type=='latex')
print(is_pdf)
```

# {.tabset .tabset-fade .tabset-pills}

##  Objectifs de la s√©ance  

* Construire des plans fractionnaires avec "beaucoup" de facteurs
* Proposer des plans permettant de tester des interactions

## Exercices 


###  Plan 2<sup>6-2</sup>

L'objectif de cet exercice est de construire un plan de r√©solution IV permettant d'√©tudier 6 facteurs √† 2 niveaux en 16 essais.

1. Combien d'essais sont n√©cessaires pour construire un plan complet √† 6 facteurs ?
2. Quel plan de base choisissez-vous pour √©tudier les 6 facteurs en 16 essais ?

On se propose d'√©tudier le mod√®le satur√© associ√© √† ce plan. La matrice des effets contient les colonnes suivantes :

```{r, echo = FALSE, results='markup', eval = TRUE}
data <- data.frame(AA="I",A=1,B=2,C=3,D=4,E=12,F=13,G=14,H=23,I=24,J=34,K=123,L=124,M=134,N=234,O=1234)
data %>% kable(digits=2, format = "html",col.names = NULL) %>%
    collapse_rows(columns = 1, valign = 'top') %>%
  kable_classic(full_width = F, html_font = "Cambria")

```

3. Avec quels effets choisissez-vous de confondre les facteurs 5 et 6 ? D√©duire toutes les autres confusions du plan. Quelle est la r√©solution de ce plan ?
4. Peut-on estimer sans ambigu√Øt√© tous les effets principaux et toutes les interactions d'ordre 2 ?
5. Combien doit-on r√©aliser d'essais (au minimum) pour pouvoir estimer sans ambigu√Øt√© tous les facteurs principaux et toutes les interactions d'ordre 2 ? Et quelles hypoth√®ses doit-on faire ?

### Construction d'un plan 2<sup>8-4</sup>

On veut construire un plan √† 8 facteurs √† 2 niveaux tels que les effets principaux soient confondus avec des interactions d'ordre 3 ou plus.

1. Donner les g√©n√©rateurs d'alias d'un tel plan.
2. Les effets principaux sont-ils estimables sans ambigu√Øt√© ?
3. Est-il possible d'estimer quelques interactions d'ordre 2 avec le plan que vous avez construit ? Si oui, combien ? Si toutes les interactions d'ordre 2 ne peuvent pas √™tre estim√©es, comment faire pour pouvoir toutes les tester ?

### Comment peser avec pr√©cision?

On s'int√©resse √† la pr√©cision des mesures de pes√©es effectu√©es par une balance de Roberval. On d√©sire peser 4 objets A, B, C et D avec le maximum de pr√©cision. On sait que pour une pes√©e, la pr√©cision avec cette balance est de l'ordre de 1 gramme (i.e. l'√©cart-type est de 1 gramme, indication fournie par le constructeur). 

On va utiliser la m√©thodologie des plans d'exp√©riences en consid√©rant qu'un objet correspond √† 1 facteur. On
utilisera la convention suivante : si l'objet est d√©pos√© dans le plateau de gauche, le poids est compt√© positivement; s'il est d√©pos√© dans le plateau de droite, le poids est compt√© n√©gativement ; et si l'objet n'est sur aucun plateau, son poids n'est pas compt√©.

La matrice des essais correspondant √† la pes√©e classique dans lequel on p√®se les objets s√©par√©ment est donn√©e dans le tableau 1.

```{r, echo = FALSE, results='markup', eval = TRUE}
data <- data.frame(Essai=c("pes√©e 1","pes√©e 2","pes√©e 3","pes√©e 4"),A=c(1,0,0,0),B=c(0,1,0,0),C=c(0,0,1,0),D=c(0,0,0,1))
data %>% kable(digits=2, format = "html", escape = FALSE, caption="Tableau 1") %>%
    collapse_rows(columns = 1, valign = 'top') %>%
  kable_classic(full_width = F, html_font = "Cambria")

```


On d√©cide de faire les pes√©es selon le plan du tableau 2 :

```{r, echo = FALSE, results='markup', eval = TRUE}
data <- data.frame(Essai=c("pes√©e 1","pes√©e 2","pes√©e 3","pes√©e 4"),G=c("A,B,C,D","A,B","A,C","A,D"),D=c("aucun","C,D","B,D","B,C"),P=c(150,50,10,30))
names(data) <- c("Essai","Objects √† gauche","Objects √† droite","Poids ajout√©s √† droite")
data %>% kable(digits=2, format = "html", escape = FALSE, caption="Tableau 2") %>%
    collapse_rows(columns = 1, valign = 'top') %>%
  kable_classic(full_width = F, html_font = "Cambria")

```

Les r√©sultats des pes√©es (en gramme) sont les suivantes : Y<sub>1</sub> = 150, Y<sub>2</sub> = 50, Y<sub>3</sub> = 10, Y<sub>4</sub> = 30.

1. Donner le plan d'exp√©riences qui a √©t√© utilis√© lors de ces 4 pes√©es sous forme de matrice.
2. Apr√®s avoir pr√©cis√© √† quel param√®tre correspondait le poids de chaque objet, donner une estimation du poids
de chaque objet.
3. Comment peut-on calculer la pr√©cision des estimations de poids ? Quelle est la pr√©cision de chacune des
estimations de poids (sachant que la pr√©cision de la balance est  = 1 gramme) ?

## Le vocabulaire de la s√©ance

### Statistique 
- R√©solution d'un plan fractionnaire
- Alias

