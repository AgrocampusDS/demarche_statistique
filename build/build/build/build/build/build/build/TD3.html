<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UP Mathématique appliquée" />


<title>TD3 : Tester l’existence d’un effet groupe</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Agrocampus Ouest : démarche statistique</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AgrocampusDS/demarche_statistique">
    <span class="fa fa-github"></span>
     
    
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">TD3 : Tester l’existence d’un effet groupe</h1>
<h4 class="author">UP Mathématique appliquée</h4>

</div>


<div id="section" class="section level1 tabset tabset-fade tabset-pills">
<h1 class="tabset tabset-fade tabset-pills"></h1>
<div id="objectifs-de-la-séance" class="section level2">
<h2>Objectifs de la séance</h2>
<ul>
<li>Manipulation de données
<ul>
<li>Grouper les données par modalité d’un facteur</li>
<li>Effectuer des calculs par modalité du facteur</li>
</ul></li>
<li>Visualisation de données
<ul>
<li>Boîte à moustaches</li>
</ul></li>
<li>Analyse de données
<ul>
<li>Démarche statistique</li>
<li>Reconnaître le contexte d’une analyse de la variance</li>
<li>Ecrire le modèle correspondant</li>
<li>Mettre en oeuvre le test du modèle complet</li>
</ul></li>
</ul>
</div>
<div id="exercices" class="section level2">
<h2>Exercices</h2>
<p>Le problème qui suit est inspiré d’un stage de fin d’études réalisé par une étudiante de la spécialisation <em>Science des données</em> du cursus d’ingénieur agro-alimentaire d’Agrocampus.</p>
<p>Un groupe industriel commercialisant du café souhaite comparer les cafés provenant de différents lieux de production à partir de leur profil de composition physico-chimique, dont une des composantes importantes est le taux de matière sèche (<code>DM</code>). Pour cela, il s’appuie sur des données contenant le lieu de production, codé par un entier allant de <code>1</code> à <code>7</code>, de 240 mesures de café disponible sur l’onglet Scripts et données de la <a href="https://agrocampusds.github.io/demarche_statistique/index.html">page d’accueil du module</a>.</p>
<div id="description-des-données-sur-la-qualité-du-café" class="section level3">
<h3>Description des données sur la qualité du café</h3>
<div id="importation-des-données" class="section level4">
<h4>Importation des données</h4>
<ul>
<li><p>Importer le fichier de données <code>cafe_DM.csv</code> disponible sur la page des <a href="index.html">jeux de données</a> dans un objet nommé <code>cafe</code> en utilisant un script <code>TD3_script.R</code> que vous aurez créé dans votre répertoire de projet.</p></li>
<li><p>Quels sont les noms des variables de ce tableau de données ?</p></li>
<li><p>La nature de chacune de ces variables, telle que déclarée dans <code>R</code>, correspond-elle à votre appréciation personnelle ?</p></li>
</ul>
<p><code>R</code> traite la variable <code>Localisation</code>, un entier compris entre 1 et 7, comme une variable quantitative. Il faut indiquer à <code>R</code> que cette variable est en fait une variable qualitative, un facteur :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cafe <span class="ot">&lt;-</span> cafe <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Localisation =</span> <span class="fu">as.factor</span>(Localisation))</span></code></pre></div>
<ul>
<li>Après cette transformation, la nature de chacune de ces variables correspond-elle finalement à votre appréciation personnelle ?</li>
</ul>
</div>
<div id="visualisation-des-données" class="section level4">
<h4>Visualisation des données</h4>
<ul>
<li>Construire maintenant une boîte à moustaches des taux de matière sèche pour chaque site de production des cafés.</li>
</ul>
</div>
<div id="calcul-de-statistiques-descriptives" class="section level4">
<h4>Calcul de statistiques descriptives</h4>
<p>La commande suivante permet de calculer la moyenne de matière sèche pour chaque site de production de café :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cafe <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Localisation) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">DM_mean =</span> <span class="fu">mean</span>(DM))</span></code></pre></div>
<pre><code>## # A tibble: 7 × 2
##   Localisation DM_mean
##   &lt;fct&gt;          &lt;dbl&gt;
## 1 1               90.4
## 2 2               90.3
## 3 3               89.7
## 4 4               91.4
## 5 5               90.1
## 6 6               90.0
## 7 7               90.5</code></pre>
<ul>
<li>Calculer la médiane et l’écart-type pour chaque site de production.</li>
</ul>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Localisation
</th>
<th style="text-align:right;">
DM_mean
</th>
<th style="text-align:right;">
DM_q50
</th>
<th style="text-align:right;">
DM_sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
90.40
</td>
<td style="text-align:right;">
90.51
</td>
<td style="text-align:right;">
0.44
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
90.26
</td>
<td style="text-align:right;">
90.29
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
89.69
</td>
<td style="text-align:right;">
89.79
</td>
<td style="text-align:right;">
0.41
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
91.37
</td>
<td style="text-align:right;">
91.32
</td>
<td style="text-align:right;">
0.45
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
90.13
</td>
<td style="text-align:right;">
90.12
</td>
<td style="text-align:right;">
0.41
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
89.99
</td>
<td style="text-align:right;">
89.99
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
90.50
</td>
<td style="text-align:right;">
90.53
</td>
<td style="text-align:right;">
0.64
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="modélisation-statistique" class="section level3">
<h3>Modélisation statistique</h3>
<p>On cherche à répondre à la question suivante : Les taux de matière sèche moyens à l’échelle de toute la production diffèrent-ils d’un site à l’autre ?</p>
<div id="mise-en-place-de-lanalyse-statistique" class="section level4">
<h4>Mise en place de l’analyse statistique</h4>
<ul>
<li><p>Donner l’expression du modèle statistique M<span class="math inline">\(_1\)</span> permettant de répondre à cette question ? Quels sont les paramètres de ce modèle ?</p></li>
<li><p>Quelles sont les hypothèses H<span class="math inline">\(_{0}\)</span> et H<span class="math inline">\(_{1}\)</span> du test de l’existence de différences moyennes de taux de matière sèche entre les sites de production ? Exprimer ces hypothèses à partir des paramètres du modèle de la question précédente.</p></li>
</ul>
</div>
<div id="ajustement-du-modèle" class="section level4">
<h4>Ajustement du modèle</h4>
<ul>
<li><p>A l’aide des fonctions <code>lm</code> et <code>coef</code>, donner la valeur estimée des paramètres du modèle d’analyse de la variance M<span class="math inline">\(_1\)</span> introduit ci-dessus.</p></li>
<li><p>Donner l’expression mathématique du modèle nul M<span class="math inline">\(_0\)</span>.</p></li>
<li><p>Le paramètre désigné par le nom <code>Intercept</code> est-il estimé à la même valeur dans les modèles M<span class="math inline">\(_0\)</span> et M<span class="math inline">\(_1\)</span> ? Pourquoi ?</p></li>
</ul>
<p>La qualité d’ajustement d’un modèle est mesurée par la somme des carrés des écarts entre les valeurs observées de la variable réponse et les valeurs ajustées par le modèle, que l’on nomme RSS (residual sum of squares).</p>
<ul>
<li><p>Selon ce critère de qualité d’ajustement, peut-on dire que le modèle M<span class="math inline">\(_1\)</span> est beaucoup mieux ajusté aux données que le modèle M<span class="math inline">\(_0\)</span> ? Proposer une évaluation quantitative de ce gain d’ajustement.</p></li>
<li><p>Quelle est la valeur estimée de l’écart-type résiduel du modèle M<span class="math inline">\(_{1}\)</span> ?</p></li>
</ul>
</div>
<div id="test-de-leffet-site-de-production-sur-la-quantité-de-matière-sèche" class="section level4">
<h4>Test de l’effet site de production sur la quantité de matière sèche</h4>
<ul>
<li><p>Quelle est l’expression de la statistique de test permettant de tester l’existence de différences moyennes entre les lieux de production ? Quelle est la valeur prise par cette statistique de test ?</p></li>
<li><p>Quelle est la distribution <span class="math inline">\(\mathcal{F}_{0}\)</span> sous l’hypothèse H<span class="math inline">\(_{0}\)</span> de la statistique de test <span class="math inline">\(F\)</span> introduite à la question précédente ?</p></li>
</ul>
</div>
</div>
<div id="conclusion-de-létude" class="section level3">
<h3>Conclusion de l’étude</h3>
<p>La fonction <code>pf(q = .., df1 = .. , df2= .. , lower.tail = FALSE)</code> donne la probabilité qu’une variable aléatoire suivant une loi de Fisher de paramètre <code>df1</code>, <code>df2</code> dépasse la valeur <code>q</code>.<br />
<img src="TD3_files/figure-html/graph_p_value-1.png" width="672" /></p>
<ul>
<li><p>En déduire la p-value du test de comparaison des teneurs moyennes en matières sèches entre les sites de production.</p></li>
<li><p>En déduire une réponse à la question initialement posée.</p></li>
<li><p>Utiliser la fonction ‘anova’ pour repérer dans son résultat toutes les quantités que nous avons calculées dans ce TD.</p></li>
</ul>
</div>
</div>
<div id="le-vocabulaire-de-la-séance" class="section level2">
<h2>Le vocabulaire de la séance</h2>
<div id="commandes-r" class="section level3">
<h3>Commandes R</h3>
<ul>
<li>as.factor</li>
<li>group_by</li>
<li>pf</li>
<li>summarise</li>
</ul>
</div>
<div id="environnement-r" class="section level3">
<h3>Environnement R</h3>
</div>
<div id="statistique" class="section level3">
<h3>Statistique</h3>
<ul>
<li>Analyse de la variance</li>
</ul>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
